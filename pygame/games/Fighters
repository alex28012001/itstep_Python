import pygame
from pygame import mixer
from Bot import Bots


SPEED_FIGHTER = 5
SPEED_BIRD_X = 0.6
SPEED_BIRD_Y = 0.2
JUMP_SPEED = 5.5
HEALTH_FIGHTER = 10000
DAMAGE_FIGHTER = 1
HEALTH_BOT = 100000
DAMAGE_BOT_PROST = 10
DAMAGE_BOT_SIL = 100
GRAVITY = 0.09


"""размер окна"""
SIZE = (1450, 770)



"""создание окна"""
window = pygame.display.set_mode(SIZE)
pygame.display.set_caption("Fighters")

"""холст"""
screen = pygame.image.load("images/fon.png").convert()
screen = pygame.transform.scale(screen, (SIZE))
clock = pygame.time.Clock()

"""холст фейк"""
screen_fake = pygame.Surface(SIZE)



"""шрифты"""
pygame.font.init()
font = pygame.font.SysFont("Candara", 25)
font2 = pygame.font.SysFont("Candara", 17)




"""создание обектов"""
bird = pygame.image.load("images/bird.png").convert_alpha()
bird = pygame.transform.scale(bird, (70, 70))
birdq = bird

birdleft = pygame.image.load("images/birdleft.png").convert_alpha()
birdleft = pygame.transform.scale(birdleft, (70, 70))
birdw = birdleft


birdnew1 = pygame.image.load("images/bird.png").convert_alpha()
birdnew1 = pygame.transform.scale(birdnew1, (70, 70))
birdt = birdnew1








"""Fighter (анимация)"""
fighter = pygame.image.load("images/fighter.png").convert_alpha()
fighter_copy = fighter

fighter_down = pygame.image.load("images/fighter_down.png").convert_alpha()
fighter_down_copy = fighter_down

fighter_left = pygame.image.load("images/fighter_left.png").convert_alpha()
fighter_left_copy = fighter_left

fighter_right = pygame.image.load("images/fighter_right.png").convert_alpha()
fighter_right_copy = fighter_right

fighter_up = pygame.image.load("images/fighter_up.png").convert_alpha()
fighter_up_copy = fighter_up

"""атаки Fighters"""
fighter_atack_stay = pygame.image.load("images/fighter_atack_stay.png").convert_alpha()
fighter_atack_stay_copy = fighter_atack_stay

fighter_atack_stay_2 = pygame.image.load("images/fighter_atack_stay(2).png").convert_alpha()
fighter_atack_stay_2_copy = fighter_atack_stay_2

fighter_right_atack = pygame.image.load("images/fighter_right_atack.png").convert_alpha()
fighter_right_atack_copy = fighter_right_atack

fighter_left_atack = pygame.image.load("images/fighter_left_atack.png").convert_alpha()
fighter_left_atack_copy = fighter_left_atack

"""БОТ"""
bot = pygame.image.load("images/bot.png").convert_alpha()
bot_copy = bot

"""Атаки Бота"""
bot_atack_right = pygame.image.load("images/bot_atack_right.png").convert_alpha()
bot_atack_right_copy = bot_atack_right

bot_atack_left = pygame.image.load("images/bot_atack_left.png").convert_alpha()
bot_atack_left_copy = bot_atack_left









"""координаты птиц"""
bird_right = True
bird_down = True
bird_x = 0
bird_y = 0

birdnew1_right = True
birdnew1_down = True
birdnew1_x = -600
birdnew1_y = 80


"""координаты бойца"""
fighter_right = False
fighter_left = False
fighterdown = False
fighter_up = False
fighter_atack_1 = False
fighter_atack_2 = False
fighter_right_atacks = False
fighter_left_atacks = False
onGROUND = False
fighter_yvel = 0
fighter_x = 70
fighter_y = 250





"""координаты бота"""
bot_right = bot_left = False
bot_atack1 = False
bot_atack2 = False
"""1 БОТ"""
bot1 = Bots(600, 520, fighter_x, fighter_y, bot, bot_atack_right, bot_atack_left)






"""функция для столкновения обьектов"""
def Intersect(x1, x2, y1, y2):
    if (x1 > x2-135) and (x1 < x2 + 159) and (y1 > y2- 140) and (y1 < y2+ 185):
        return 1
    else:
        return 0






"""Фоновая музыка"""
mixer.pre_init(44100, -16, 1, 512)
mixer.init()
sound = mixer.Sound("sounds/metro_2033.ogg")
sound.play(-1)







"""обработчик событий"""
done = True
while done:
    timer = pygame.time.get_ticks()/1000
    print(int(timer))

    for e in pygame.event.get():
        if e.type == pygame.QUIT:
            done = False



        """событие нажатие на мыщку"""
        if e.type == pygame.MOUSEBUTTONDOWN:
            if e.button == 3:
                 fighter_atack_1 = True


            if e.button == 1:
                fighter_atack_2 = True



        """событие отжатие на мышку"""
        if e.type == pygame.MOUSEBUTTONUP:
            if e.button == 3:
                fighter_atack_1 = False
                fighter = fighter_copy


            if e.button == 1:
                fighter_atack_2 = False
                fighter = fighter_copy








        """событие нажатия на клавиатуру"""
        if e.type == pygame.KEYDOWN :

            if e.key == pygame.K_d:
                fighter_right = True

            if e.key == pygame.K_a:
                fighter_left = True

            if e.key == pygame.K_s:
                fighterdown = True

            if e.key == pygame.K_e:
                fighter_right_atacks = True

            if e.key == pygame.K_q:
                fighter_left_atacks = True

            if fighter_y > 544:
                if e.key == pygame.K_SPACE:
                    fighter_up = True







        """событие отжатие клавиатуры"""
        if e.type == pygame.KEYUP:

            if e.key == pygame.K_d:
                fighter_right = False
                fighter = fighter_copy

            if e.key == pygame.K_a:
                fighter_left = False
                fighter = fighter_copy

            if e.key == pygame.K_s:
                fighterdown = False
                fighter = fighter_copy



            if e.key == pygame.K_e:
                fighter_right_atacks = False
                fighter = fighter_copy

            if e.key == pygame.K_q:
                fighter_left_atacks = False
                fighter = fighter_copy











    """Условия передвежения Fighter"""
    if fighter_right == True:
        fighter = fighter_right_copy
        if fighter_x < 1350:
            fighter_x += SPEED_FIGHTER


    if fighter_left == True:
        fighter = fighter_left_copy
        if fighter_x > 0:
            fighter_x -= SPEED_FIGHTER


    if fighterdown == True:
        fighter = fighter_down_copy




    """Прыжок"""
    if fighter_up == True:
            onGROUND = True
            fighter = fighter_up_copy
            if fighter_y > 200:
                for i in range(20):
                    fighter_y -= 0.3

            else:
                fighter_up = False
                onGROUND = False

    if onGROUND == True:
        fighter_yvel = 0


    """Падение"""
    if onGROUND == False:
        fighter = fighter_copy
        if fighter_y < 545:
            fighter_yvel += GRAVITY
            fighter_y += fighter_yvel


















    """атаки Fighters"""
    if fighter_atack_1 == True:
        fighter = fighter_atack_stay_copy


    if fighter_atack_2 == True:
        fighter = fighter_atack_stay_2_copy


    if fighter_right_atacks == True:
        fighter = fighter_right_atack_copy

    if fighter_left_atacks == True:
        fighter = fighter_left_atack_copy














    """Передвежение 1 птицы по оси X"""
    if bird_right == True:
        bird_x += SPEED_BIRD_X
        if bird_x > 1500:
            bird_right = False


    else:
        bird = birdw
        bird_x -= SPEED_BIRD_X
        if bird_x < -70:
            bird = birdq
            bird_right = True


    """Передвежение 1 птицы по оси y"""
    if bird_down == True:
        bird_y += SPEED_BIRD_Y
        if bird_y > 70:
            bird_down = False


    else:
        bird_y -= SPEED_BIRD_Y
        if bird_y < 20:
            bird_down = True










    """Передвежение 2 птицы по оси X"""
    if birdnew1_right == True:
        birdnew1_x += SPEED_BIRD_X
        if birdnew1_x > 1500:
            birdnew1_right = False


    else:
        birdnew1 = birdw
        birdnew1_x -= SPEED_BIRD_X
        if birdnew1_x < -70:
            birdnew1 = birdt
            birdnew1_right = True


    """Передвежение 2 птицы по оси y"""
    if birdnew1_down == True:
        birdnew1_y += SPEED_BIRD_Y
        if birdnew1_y > 150:
            birdnew1_down = False


    else:
        birdnew1_y -= SPEED_BIRD_Y
        if birdnew1_y < 80:
            birdnew1_down = True












    """Передвежение бота по оси x"""
    bot1.update(fighter_x, fighter_y, bot)




    """заливка фейкового холста"""
    screen_fake.fill((50, 50, 50))







    """столкновение c ботом"""
    if Intersect(fighter_x, bot1.bot_x, fighter_y, bot1.bot_y) == True:

        """право(бот)"""
        if fighter_x > bot1.bot_x:
            fighter_left = False
            bot_atack1 = True
            bot_atack2 = False

            """атака вправо от бота"""
            if bot_atack1 == True:
                bot = bot_atack_right
                HEALTH_FIGHTER -= DAMAGE_FIGHTER

            else:
                bot = bot_copy

            """простая атака влево от fighter"""
            if fighter_atack_2:
                HEALTH_BOT -= DAMAGE_BOT_PROST

            """сильная атака от fighter"""
            if fighter_left_atacks == True:
                HEALTH_BOT -= DAMAGE_BOT_SIL








        """лево(бот)"""
        if fighter_x < bot1.bot_x:
            fighter_right = False
            bot_atack2 = True
            bot_atack1 = False

            """атака влево от бота"""
            if bot_atack2 == True:
                bot = bot_atack_left
                HEALTH_FIGHTER -= DAMAGE_FIGHTER

            else:
                bot = bot_copy



            """простая атака вправо от fighter"""
            if fighter_atack_1:
                HEALTH_BOT -= DAMAGE_BOT_PROST

            """сильная атака от fighter"""
            if fighter_right_atacks == True:
                HEALTH_BOT -= DAMAGE_BOT_SIL



    else:
        bot = bot_copy












    """отоброжение обьектов"""
    screen_fake.blit(screen, (0, 0))
    screen_fake.blit(font.render('Health Fighter: '+str(HEALTH_FIGHTER), 5, (117, 74, 103)), (45, 20))
    screen_fake.blit(font.render('Health Bot: ' + str(HEALTH_BOT), 5, (117, 74, 103)), (45, 50))
    screen_fake.blit(font2.render('fps: ' + str(int(clock.get_fps())), 5, (117, 74, 103)), (1370, 20))
    bot1.draw(screen_fake)
    screen_fake.blit(fighter, (fighter_x, fighter_y))
    screen_fake.blit(bird, (bird_x, bird_y))
    screen_fake.blit(birdnew1, (birdnew1_x, birdnew1_y))


    """отображение рабочей поверхности на экран"""

    window.blit(screen_fake, (0, 0))
    clock.tick(0)
    pygame.display.flip()












